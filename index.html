<!DOCTYPE html>
<html lang="en">
	<head>
		<title>music 34 final project</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #f0f0f0;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	</head>
	<body>

    <script src="./js/howler.min.js"></script>
    <script src="./js/howler.spatial.min.js"></script>
		<script src="./js/three.min.js"></script>
		<script src="./js/OrbitControls.js"></script>

		<script>
			var container;
			var camera, controls, scene, renderer;
			var objects = [];

			init();
			animate();

			function init() {
				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 10000 );
				camera.position.x = 500;
				camera.position.y = 100;
				camera.position.z = 500;
				controls = new THREE.OrbitControls( camera );

				scene = new THREE.Scene();
				scene.background = new THREE.Color( 0xf0f0f0 );
				scene.add( new THREE.AmbientLight( 0x505050 ) );

				var light = new THREE.SpotLight( 0xffffff, 1.5 );
				light.position.set( 0, 500, 2000 );
				light.castShadow = true;
				light.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 50, 1, 200, 10000 ) );
				light.shadow.bias = - 0.00022;
				light.shadow.mapSize.width = 2048;
				light.shadow.mapSize.height = 2048;

				scene.add( light );

				var wallGeometry = new THREE.PlaneGeometry( 1000, 1000 );
				var wallMesh = new THREE.Mesh( wallGeometry, new THREE.MeshLambertMaterial( { color: "white"} ));
				wallMesh.rotation.x = -Math.PI / 2;
				wallMesh.castShadow = false;
				wallMesh.receiveShadow = true;
				console.log(wallMesh)
				scene.add(wallMesh);

				var box = new THREE.BoxGeometry( 40, 40, 40 );
        var sphere = new THREE.SphereGeometry( 5, 5, 5 );
				for ( var i = 0; i < 3; i ++ ) {
					var object = new THREE.Mesh( box, new THREE.MeshLambertMaterial( { color: "#966F33"} ) );
					object.position.x = Math.random() * 300;
					object.position.y = 1 ;
					object.position.z = Math.random() * 300;
					object.castShadow = true;
					object.receiveShadow = true;
					scene.add( object );
					objects.push( object );

          object2 = new THREE.Mesh( sphere, new THREE.MeshLambertMaterial( { color: "white"} ) );
					object2.position.x = object.position.x;
					object2.position.y = object.position.y + 25;
					object2.position.z = object.position.z;
					object2.castShadow = true;
					object2.receiveShadow = true;
					scene.add( object2 );
					objects.push( object2 );

					var sound1 = new Howl({
			    	src: ['./media/placeholder.mp3'],
						autoplay: true,
			  		loop: true,
						volume: 0.05,
						pos: [object2.position.x, object2.position.y, object2.position.z]
			  	});
				}

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.shadowMap.enabled = true;
				renderer.shadowMap.type = THREE.PCFShadowMap;
				container.appendChild( renderer.domElement );
				window.addEventListener( 'resize', onWindowResize, false );
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function animate() {
				requestAnimationFrame( animate );
				render();
			}

			function render() {
				controls.update();
				renderer.render( scene, camera );
			}

		</script>

	</body>
</html>
